---
title: "Exploratory markdown"
author: "Hannah Haskell"
date: "4/15/2021"
output: pdf_document
---
```{r setup, include=FALSE}
#setting the working directory
knitr::opts_knit$set(root.dir = '/Users/hannahhaskell/Desktop/')
```

## Libraries

`tidyverse`

`lubridate`

`gapminder`

`modelr`

`broom`

## Data

A single data file will be uploaded for this exploratory analysis. The BIO539_mock_data includes  physiological measurements of the oysters during the exposure trials as well as size measurements (shell length), moralities and the number of algae cells cleared over time during a post exposure clearance rate trial.  

```{r loading the data, include=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(gapminder)
library(knitr)
library(modelr)
library(broom)

CEA_data <- read_csv("BIO539_mock_data.csv")

```

## Basic Data Exploration

### CEA Data:

**Rows:** n = `r nrow(CEA_data)`

**Columns:** n = `r ncol(CEA_data)`

**Column Names:** `r names(CEA_data)`


After looking over the column names it appears that the CEA data seems a bit disorganized. It looks like there are some spaces left between columns that should be removed and multiple different types of data included in the single file. I think it is worth while to assign a few variables to help separate and organize all of the data for subsequent analyses. 


```{r Cleaning up CEA_data, include = FALSE}

#Assigning new variables to help organize the data/information better


#CEA  data
Cleaned_CEA_data <- subset (CEA_data, select = -c(12:23)) %>% #CEA only
  rename(
    "Fiber_concentration" = "Fiber concentration",
    "Replicate" = "Tank (replicate #)",
    "Animal_ID" = "Animal ID #")

#Mortality data
Mortality <- subset (CEA_data, select = c(15:18)) %>%
  rename(
    "Treatment" = "Treatment a",
    "Fiber_concentration" = "Fiber concentration a",
    "End_exp_mortality" = "End of expt. mortality") %>%
  filter(!is.na(End_exp_mortality))


#Growth data
Growth <- subset (CEA_data, select = c(1,3,4,12)) %>%
  rename(
    "Fiber_concentration" = "Fiber concentration",
    "Shell_length" = "Shell width (mm)")
```

```{r summary tables, include=FALSE}
#Generating summary tables to get a feel for the range of data
summary(Cleaned_CEA_data)
summary(Growth)
summary(Mortality)
```





To start, I am curious to see if there was any noticeable growth among the oysters over the duration of the experiment. 

Basic plots of shell length and tissue mass by day to determine if there was any growth overall in the oysters during the duration of the experiment (regardless of treatment exposure) 
```{r plots of shell length and tissue mass (regardless of treatment), include=FALSE}

#Generate new data set that includes the average shell length and tissue mass for each sample day
Growth_averages <- Growth %>%
  group_by(Day) %>%
  summarise(mean_shell_length = mean(Shell_length), mean_tissue_mass = mean(Tissue_mass))

```
```{r plot of shell length, fig.height=3, fig.width=4, echo=FALSE}
#plot these to see if there was any shell growth over the duration of the experiment 

ggplot(Growth_averages, aes(Day, mean_shell_length)) +
  geom_line() +
  labs(x = "Day", y = "Mean Shell Length (mm)") +
  scale_x_continuous(breaks = c(0, 15, 30, 45, 60, 75, 90))
```

**Figure 1.** Mean shell length of oysters per sample day over the duration of the experiment. Overall there is an obvious upward trend indicating that there was indeed some shell growth during the experiment. 

```{r plot of tissue mass, fig.height=3, fig.width=4, echo=FALSE}
ggplot(Growth_averages, aes(Day, mean_tissue_mass)) +
  geom_line() +
  labs(x = "Day", y = "Mean Wet Tissue Mass (g)") +
  scale_x_continuous(breaks = c(0, 15, 30, 45, 60, 75, 90))
```

**Figure 2.** Mean wet tissue mass of oysters per sample day over the duration of the experiment. Overall there is an upward trend with the largest increase in tissue mass occurring after day 75. 

These two plots tell me that there was at least some growth occurring in the oysters over the duration of the experiment indicating that our husbandry techniques were sufficient enough to allow for proper growth to occur.  


I am now curious to see if there was any differences in growth trends between treatments.

```{r average growth grouped by day and by treatment, include = FALSE}
#Make new data set that averages the growth by day and treatment 
Growth_averages_treatment <- Growth %>%
  group_by(Day, Treatment) %>%
  summarise(mean_shell_length = mean(Shell_length), mean_tissue_mass = mean(Tissue_mass))
```
```{r plot shell length growth grouped by treatment, fig.height=4, fig.width=6, echo=FALSE}
ggplot(Growth_averages_treatment, aes(Day, mean_shell_length, color = factor(Treatment, labels = c("1 Fiber/mL", "1 Fiber/mL + PCB", "10 Fibers/mL", "10 Fiber/mL + PCB", "Control")))) +
  geom_line() +
  labs(x = "Day", y = "Mean Shell Length (mm)", color = "Treatment") +
  scale_x_continuous(breaks = c(0, 15, 30, 45, 60, 75, 90))
  
```

**Figure 3.** Mean oyster shell length by treatment and by day. Variations within the data may potentially be a result of damage/breakage of shells while being handled throughout the experiment. Overall trends appear similar among the treatment groups with the exception of 10 Fibers/mL + PCB which appears to have experienced less shell growth overall. 


```{r plot wet tissue mass grouped by treatment, fig.height=4, fig.width=6, echo=FALSE}
ggplot(Growth_averages_treatment, aes(Day, mean_tissue_mass, color = factor(Treatment, labels = c("1 Fiber/mL", "1 Fiber/mL + PCB", "10 Fibers/mL", "10 Fiber/mL + PCB", "Control")))) +
  geom_line() +
  labs(x = "Day", y = "Mean Wet Tissue Mass (g)", color = "Treatment") +
  scale_x_continuous(breaks = c(0, 15, 30, 45, 60, 75, 90))

```

**Figure 4.** Mean wet tissue mass by treatment and by day. Overall increase in mean tissue mass among all treatment groups. Oysters exposed to PCBs appear to have the smallest increase in tissue mass out of all the experimental treatments. 
