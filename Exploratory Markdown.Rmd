---
title: "Exploratory markdown"
author: "Hannah Haskell"
date: "4/15/2021"
output: pdf_document
---
```{r setup, include=FALSE}
#setting the working directory
knitr::opts_knit$set(root.dir = '/Users/hannahhaskell/Desktop/')
```

## Libraries

`tidyverse`

`lubridate`

`gapminder`

`modelr`

`broom`

## Data

A single data file will be uploaded for this exploratory analysis. The BIO539_mock_data includes  physiological measurements of the oysters during the exposure trials as well as size measurements (shell length), moralities and the number of algae cells cleared over time during a post exposure clearance rate trial.  

```{r loading the data, include=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(gapminder)
library(knitr)
library(modelr)
library(broom)

CEA_data <- read_csv("BIO539_mock_data.csv")

```

## Basic Data Exploration

### CEA Data:

**Rows:** n = `r nrow(CEA_data)`

**Columns:** n = `r ncol(CEA_data)`

**Column Names:** `r names(CEA_data)`


After looking over the column names it appears that the CEA data seems a bit disorganized. It looks like there are some spaces left between columns that should be removed and multiple different types of data included in the single file. I think it is worth while to assign a few variables to help separate and organize all of the data for subsequent analyses. 


```{r Cleaning up CEA_data, include = FALSE}

#Assigning new variables to help organize the data/information better


#CEA  data
Cleaned_CEA_data <- subset (CEA_data, select = -c(12:23)) %>% #CEA only
  rename(
    "Fiber_concentration" = "Fiber concentration",
    "Replicate" = "Tank (replicate #)",
    "Animal_ID" = "Animal ID #")

#Mortality data
Mortality <- subset (CEA_data, select = c(15:18)) %>%
  rename(
    "Treatment" = "Treatment a",
    "Fiber_concentration" = "Fiber concentration a",
    "End_exp_mortality" = "End of expt. mortality") %>%
  filter(!is.na(End_exp_mortality))


#Growth data
Growth <- subset (CEA_data, select = c(1,3,4,12)) %>%
  rename(
    "Fiber_concentration" = "Fiber concentration",
    "Shell_length" = "Shell width (mm)")
```

```{r summary tables, include=FALSE}
#Generating summary tables to get a feel for the range of data
summary(Cleaned_CEA_data)
summary(Growth)
summary(Mortality)
```


To begin the exploratory analysis, I am curious to see if there was any noticeable growth among the oysters over the duration of the experiment. 

```{r plot of shell length, include=FALSE}

#Generate new data set that includes the average shell length and tissue mass for each sample day
Growth_averages <- Growth %>%
  group_by(Day) %>%
  summarise(mean_shell_length = mean(Shell_length), mean_tissue_mass = mean(Tissue_mass))

```
```{r plot of shell length, fig.height=4, fig.width=6, echo=FALSE}
#plot these to see if there was any shell growth over the duration of the experiment 

ggplot(Growth, aes(Treatment, Shell_length)) +
  geom_boxplot() +
  labs(x = "Treatment", y = "Shell Length (mm)") +
  scale_x_discrete(limits = c("Baseline", "Control", "[Fiber 1]", "[Fiber 1] + PCB", "[Fiber 2]", "[Fiber 2] + PCB")) #changing the order of the x axis
  
```

**Figure 1.** Shell length of oysters (n = 8 per treatment). Baseline measurements represent shell length at the beginning of the experiment. All other lengths were measured 3 months after the baseline measurements, at the end of the experiment. Overall there appears to have been consistent growth among treatment groups with the exception of the [Fiber 2] + PCB group which had less growth overall.

I am now curious to see if the differences in growth between the baseline and control/treatments are actually significant, especially the [Fiber 2] + PCB group.




